<!DOCTYPE html>
<html>
<head>
    <title>TopoMind Control Panel</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #fafafa; }
        textarea, input { width: 100%; margin-top: 6px; padding: 6px; }
        button { padding: 8px 16px; margin-top: 10px; cursor: pointer; }
        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .section { background: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
    </style>
</head>
<body>

<h1>TopoMind Dynamic Platform</h1>

<div class="section">
<h2>Query</h2>
<textarea id="queryInput">Calculate sum of 1 to 5</textarea>
<button onclick="sendQuery()">Send Query</button>
<pre id="queryResponse">Waiting...</pre>
</div>

<div class="section">
<h2>Register REST Connector</h2>
<input id="connectorName" placeholder="Connector Name (e.g. hawk_runtime)" />
<input id="connectorBaseUrl" placeholder="Base URL (e.g. http://localhost:9000)" />
<button onclick="registerRestConnector()">Register REST Connector</button>
<pre id="connectorOutput">Not submitted</pre>
</div>

<div class="section">
<h2>Register Tool</h2>
<input id="toolName" placeholder="Tool Name (e.g. executeHawk)" />
<input id="toolDescription" placeholder="Description" />
<input id="toolConnector" placeholder="Connector Name (e.g. hawk_runtime)" />
<label>Strict Mode:</label>
<input type="checkbox" id="toolStrict" />

<textarea id="toolPrompt" placeholder="Tool Prompt (for LLM planner)"></textarea>

<textarea id="toolInputSchema">
{"code":"string"}
</textarea>

<textarea id="toolOutputSchema">
{"code":"string"}
</textarea>

<button onclick="registerTool()">Register Tool</button>
<pre id="toolOutput">Not submitted</pre>
</div>

<div class="section">
<h2>Capabilities</h2>
<button onclick="loadCapabilities()">Load</button>
<pre id="capabilitiesOutput"></pre>
</div>

<script>
const BASE_URL = "http://127.0.0.1:8000";

async function sendQuery() {
    const output = document.getElementById("queryResponse");
    output.textContent = "Loading...";
    const response = await fetch(BASE_URL + "/query", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query: document.getElementById("queryInput").value })
    });
    const data = await response.json();
    output.textContent = JSON.stringify(data, null, 2);
}

async function registerRestConnector() {
    const response = await fetch(BASE_URL + "/register-connector", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: document.getElementById("connectorName").value,
            type: "rest",
            base_url: document.getElementById("connectorBaseUrl").value
        })
    });
    const data = await response.json();
    document.getElementById("connectorOutput").textContent = JSON.stringify(data, null, 2);
}

async function registerTool() {
    const response = await fetch(BASE_URL + "/register-tool", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: document.getElementById("toolName").value,
            description: document.getElementById("toolDescription").value,
            input_schema: JSON.parse(document.getElementById("toolInputSchema").value),
            output_schema: JSON.parse(document.getElementById("toolOutputSchema").value),
            connector: document.getElementById("toolConnector").value,
            prompt: document.getElementById("toolPrompt").value,
            strict: document.getElementById("toolStrict").checked
        })
    });
    const data = await response.json();
    document.getElementById("toolOutput").textContent = JSON.stringify(data, null, 2);
}

async function loadCapabilities() {
    const response = await fetch(BASE_URL + "/capabilities");
    const data = await response.json();
    document.getElementById("capabilitiesOutput").textContent = JSON.stringify(data, null, 2);
}
</script>

</body>
</html>
